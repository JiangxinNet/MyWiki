# color_system

## RGB (Red, Green, Blue) 红绿蓝
	计算机色彩显示器和彩色电视机显示色彩的原理一样，都是采用R、G、B相加混色的原理，通过发射出三种不同强度的电子束，使屏幕内侧覆盖的红、绿、蓝磷光材料发光而产生色彩。这种色彩的表示方法称为RGB色彩空间表示。
	
	在RGB颜色空间中，任意色光F都可以用R、G、B三色不同分量的相加混合而成：F=r[R]+r[G]+r[B]。RGB色彩空间还可以用一个三维的立方体来描述。当三基色分量都为0(最弱)时混合为黑色光；当三基色都为k(最大，值由存储空间决定)时混合为白色光。
	
	RGB色彩空间采用物理三基色表示，因而物理意义很清楚，适合彩色显象管工作。
	
### RGB555
	RGB555是一种16位的RGB格式，各分量都用5位表示，剩下的一位不用。
	高字节 -> 低字节 XRRRRRGGGGGBBBBB
	
### RGB565
	RGB565也是一种16位的RGB格式，但是R占用5位，G占用6位，B占用5位。
	高字节 -> 低字节 RRRRRGGGGGGBBBBB
	
### RGB24
	RGB24是一种24位的RGB格式，各分量占用8位，取值范围为0-255。
	高字节 -> 低字节 RRRRRRRRGGGGGGGGBBBBBBBB

### RGB32
	RGB32是一种32位的RGB格式，各分量占用8位，剩下的8位作Alpha通道或者不用。
	高字节 -> 低字节 RRRRRRRRGGGGGGGGBBBBBBBB
	
## HSV (Hue, Saturation, Value)
	HSV是根据颜色的直观特性由A. R. Smith在1978年创建的一种颜色空间, 也称六角锥体模型(Hexcone Model)。
	
	这个模型中颜色的参数分别是：色调（H），饱和度（S），明度（V）。
	
	HSV是一种将RGB色彩空间中的点在倒圆锥体中的表示方法。HSV即色相(Hue)、饱和度(Saturation)、明度(Value)，又称HSB(B即Brightness)。色相是色彩的基本属性，就是平常说的颜色的名称，如红色、黄色等。饱和度（S）是指色彩的纯度，越高色彩越纯，低则逐渐变灰，取0-100%的数值。明度（V），取0-max(计算机中HSV取值范围和存储的长度有关)。HSV颜色空间可以用一个圆锥空间模型来描述。圆锥的顶点处，V=0，H和S无定义，代表黑色。圆锥的顶面中心处V=max，S=0，H无定义，代表白色。
	
	RGB颜色空间中，三种颜色分量的取值与所生成的颜色之间的联系并不直观。而HSV颜色空间，更类似于人类感觉颜色的方式，封装了关于颜色的信息：“这是什么颜色？深浅如何？明暗如何？”
###	颜色模型
#### 色调H
	用角度度量，取值范围为0°～360°，从红色开始按逆时针方向计算，红色为0°，绿色为120°,蓝色为240°。它们的补色是：黄色为60°，青色为180°,品红为300°；
#### 饱和度S
	饱和度S表示颜色接近光谱色的程度。一种颜色，可以看成是某种光谱色与白色混合的结果。其中光谱色所占的比例愈大，颜色接近光谱色的程度就愈高，颜色的饱和度也就愈高。饱和度高，颜色则深而艳。光谱色的白光成分为0，饱和度达到最高。通常取值范围为0%～100%，值越大，颜色越饱和。
#### 明度V
	明度表示颜色明亮的程度，对于光源色，明度值与发光体的光亮度有关；对于物体色，此值和物体的透射比或反射比有关。通常取值范围为0%（黑）到100%（白）。
	
	RGB和CMY颜色模型都是面向硬件的，而HSV（Hue Saturation Value）颜色模型是面向用户的。
	
	HSV模型的三维表示从RGB立方体演化而来。设想从RGB沿立方体对角线的白色顶点向黑色顶点观察，就可以看到立方体的六边形外形。六边形边界表示色彩，水平轴表示纯度，明度沿垂直轴测量。
	
#### RGB转换HSV
```c
max=max(R,G,B)；
min=min(R,G,B)；
V=max(R,G,B)；
S=(max-min)/max；
if (R = max) H =(G-B)/(max-min)* 60；
if (G = max) H = 120+(B-R)/(max-min)* 60；
if (B = max) H = 240 +(R-G)/(max-min)* 60；
if (H < 0) H = H + 360；
```
#### HSV转换成RGB
```c
if (s = 0)
R=G=B=V;
else
H /= 60;
i = INTEGER(H);
f = H - i;
a = V * ( 1 - s );
b = V * ( 1 - s * f );
c = V * ( 1 - s * (1 - f ) );
switch(i)
case 0: R = V; G = c; B = a;
case 1: R = b; G = v; B = a;
case 2: R = a; G = v; B = c;
case 3: R = a; G = b; B = v;
case 4: R = c; G = a; B = v;
case 5: R = v; G = a; B = b;
```
## HSL(Hue, Saturation, Lightness)
	HSL即色相、饱和度、亮度。
	
	HSL类似于HSV。对于一些人，HSL更好的反映了“饱和度”和“亮度”作为两个独立参数的直觉观念，但是对于另一些人，它的饱和度定义是错误的，因为非常柔和的几乎白色的颜色在HSL可以被定义为是完全饱和的。对于HSV还是HSL更适合于人类用户界面是有争议的。
	
	在HSL中，饱和度分量总是从完全饱和色变化到等价的灰色（在HSV中，在极大值V的时候，饱和度从全饱和色变化到白色，这可以被认为是反直觉的）。
	
	在HSL中，亮度跨越从黑色过选择的色相到白色的完整范围（在HSV中，V分量只走一半行程，从黑到选择的色相）。

###RGB2HSL
设 (r, g, b)分别是一个颜色的红、绿和蓝的值，它们的值是0～255之间的整数。
h的值通常规范化到位于0到360°之间。而h = 0用于max = min的（就是灰色）时候而不是留下h未定义。
```c
R=R/255.0
G=G/255.0
B=B/255.0
max=max(R,G,B)
min=min(R,G,B)
L= (max+min)/2
if (max=min ) S=0;H=0
if (L<=0.5 && L > 0) S=(max-min)/(max+min)
if (L>0.5) S=(max-min)/(2.0-max-min)
if (B = max) H=60*(R-G)/(max-min)+240
if (G = max) H=60*(B-R)/max-min)+120
if (R=MAX && G < B) H=60*(G-B)/(max-min)+360
if (R=MAX && G >= B) H=60*(G-B)/(max-min)
```

###HSL2RGB
给定HSL空间中的 (h, s, l)值定义的一个颜色，带有h在指示色相角度的值域[0, 360]中，分别表示饱和度和亮度的s和l在值域[0, 1]中，相应在RGB空间中的 (r, g, b)三原色，带有分别对应于红色、绿色和蓝色的r, g和b也在值域[0, 255]。
```c
if (S= 0)
	 R=G=B=(L*255);
else
	if (L < 0.5) q=L*(1+S);
	if (L >= 0.5) q=L+S-(L*S);
	p = 2*L-q;
	
	R=255*Hue2RGB(p,q,H+(1/3.0));
	G=255*Hue2RGB(p,q,H);
	B=255*Hue2RGB(p,q,H-(1/3.0));


double Hue2RGB(p,q,vH)
{
	if (vH < 0 ) vH +=1;
	if (vH > 0 ) vH -= 1;
	if ((6.0 * vH) < 1) return p+(q-p)*6.0*vH;
	if ((2.0*vH) <  1) return q;
	if ((3.0*vH) < 2) return p+(p-q)*((2.0/3.0)-vH)*6.0;
	return q;
}

```
	
## YUV(YCrCb)
	YUV(亦称YCrCb)是被欧洲电视系统所采用的一种颜色编码方法。在现代彩色电视系统中，通常采用三管彩色摄像机或彩色CCD摄影机进行取像，然后把取得的彩色图像信号经分色、分别放大校正后得到RGB，再经过矩阵变换电路得到亮度信号Y和两个色差信号R-Y(即U)、B-Y(即V)，最后发送端将亮度和两个色差总共三个信号分别进行编码，用同一信道发送出去。这种色彩的表示方法就是所谓的YUV色彩空间表示。采用YUV色彩空间的重要性是它的亮度信号Y和色度信号U、V是分离的。如果只有Y信号分量而没有U、V信号分量，那么这样表示的图像就是黑白灰度图像。彩色电视采用YUV空间正是为了用亮度信号Y解决彩色电视机与黑白电视机的兼容问题，使黑白电视机也能接收彩色电视信号。

	YUV主要用于优化彩色视频信号的传输，使其向后相容老式黑白电视。与RGB视频信号传输相比，它最大的优点在于只需占用极少的频宽（RGB要求三个独立的视频信号同时传输）。其中“Y”表示明亮度（Luminance或Luma），也就是灰阶值；而“U”和“V” 表示的则是色度（Chrominance或Chroma），作用是描述影像色彩及饱和度，用于指定像素的颜色。“亮度”是透过RGB输入信号来建立的，方法是将RGB信号的特定部分叠加到一起。“色度”则定义了颜色的两个方面─色调与饱和度，分别用Cr和Cb来表示。其中，Cr反映了RGB输入信号红色部分与RGB信号亮度值之间的差异。而Cb反映的是RGB输入信号蓝色部分与RGB信号亮度值之同的差异。

### 数据格式
YUV格式分为两大类
planar（平面格式）和packed（紧缩格式）。
planar格式，先连续存储所有像素点的Y分量，紧接着存储所有像素点的U，随后存储所有像素点的V。将Y、U、V的三个分量分别存放在不同的矩阵中。
packed格式，每个像素点的Y、U、V分量是连续存储的。将Y、U、V值存储成Macro Pixels数组，和RGB的存放方式类似。

紧缩格式（packed format）中的YUV是混合在一起的，对于YUV4:4:4格式而言，用紧缩格式很合适的，因此就有了UYVY、YUYV等。平面格式（planar formats）是指每Y分量，U分量和V分量都是以独立的平面组织的，也就是说所有的U分量必须在Y分量后面，而V分量在所有的U分量后面，此一格式适用于采样（subsample）。平面格式（planar format）有I420（4:2:0）、YV12、IYUV等。

为节省带宽起见，大多数YUV格式平均使用的每像素位数都少于24位。主要的抽样（subsample）格式有YCbCr 4:2:0、YCbCr 4:2:2、YCbCr 4:1:1和YCbCr 4:4:4。YUV的表示法称为A:B:C表示法：
4:4:4表示完全取样。
4:2:2表示2:1的水平取样，垂直完全采样。
4:2:0表示2:1的水平取样，垂直2：1采样。
4:1:1表示4:1的水平取样，垂直完全采样。

YUV码流的存储格式其实与其采样的方式密切相关，主流的采样方式有三种，YUV4:4:4，YUV4:2:2，YUV4:2:0
YUV 4:4:4采样，每一个Y对应一组UV分量。
YUV 4:2:2采样，每两个Y共用一组UV分量。 
YUV 4:2:0采样，每四个Y共用一组UV分量。




###YUV2RGB/RGB2YUV
```c
Y = 0.299R + 0.587G + 0.114B
U = -0.147R - 0.289G + 0.436B
V = 0.615R - 0.515G - 0.100B
R = Y + 1.14V
G = Y - 0.39U - 0.58V
B = Y + 2.03U
```

## Reference
[图文详解YUV420数据格式](http://www.cnblogs.com/azraelly/archive/2013/01/01/2841269.html)
[YUV的数据格式](http://www.cnblogs.com/justkong/p/6589813.html)
[【OpenCV】HSV颜色识别-HSV基本颜色分量范围](https://blog.csdn.net/taily_duan/article/details/51506776)
[HSV]([https://baike.baidu.com/item/HSV/547122?fr=aladdin&fromid=12630604&fromtitle=HSV%E9%A2%9C%E8%89%B2%E7%A9%BA%E9%97%B4])
[HSL和HSV色彩空间](https://zh.wikipedia.org/wiki/HSL%E5%92%8CHSV%E8%89%B2%E5%BD%A9%E7%A9%BA%E9%97%B4)
[YUV](https://zh.wikipedia.org/zh/YUV)